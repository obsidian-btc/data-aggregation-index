Data Aggregation Index
======================

Update Messages:
  Initiated
  Started
  BatchAssembled
  BatchCopied
  Completed

GetNextBatch
  Project update entity
  If entity batch position exceeds event batch position, skip
  Perform query:
    GetNextBatch::References - queries the reference list and returns a set of destinationStreamName strings
    GetNextBatch::PublishedEvents - queries the event list and returns a set of eventDataText strings
  If result is empty, write Completed
  If result is not empty, write BatchAssembled

CopyBatch
  Project update entity
  If entity copy position exceeds event copy position, skip
  Perform copy:
    CopyBatch::References - for each destination stream, copy the event data text
    CopyBtach::PublishedEvents - for each event data text, copy to related entity stream
  Write BatchCopied

Update stream: Started is handled
  GetNextBatch

Update stream: BatchAssembled is handled
  CopyBatch

Update stream: BatchCopied is handled
  GetNextBatch
